<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formul√°rio de Diagn√≥stico Financeiro</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #d9d9d9;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .container {
    background-color: #f2f2f2;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    width: 320px;
    position: relative;
  }

  .logo {
    width: 200px;
    margin-bottom: 20px;
  }

  .question-box {
    background-color: #102d4c;
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    font-weight: bold;
    font-size: 15px;
    min-height: 70px;
  }

  .option {
    background-color: #102d4c;
    color: white;
    border: none;
    border-radius: 10px;
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .option:hover {
    background-color: #1b3f6b;
  }

  .option.selected {
    background-color: #2ecc71 !important;
    transform: scale(1.03);
    transition: all 0.25s ease;
  }

  .next-btn {
    background-color: #ffb400;
    color: white;
    border: none;
    border-radius: 10px;
    width: 60%;
    padding: 10px;
    margin-top: 20px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }

  .next-btn:hover {
    background-color: #e09b00;
  }

  .counter {
    font-size: 12px;
    color: #555;
    position: absolute;
    top: 10px;
    right: 15px;
  }

  .hidden {
    display: none;
  }

  /* anima√ß√£o leve no bot√£o do site */
  .visit-btn:hover {
    transform: scale(1.05);
    background-color: #e09b00 !important;
  }
</style>
</head>
<body>

<div class="container">
  <img src="VARIA√á√ÉO 25.png" alt="Logo Azevedo Contabilidade" class="logo">

  <div id="user-info">
    <h3>Relat√≥rio Financeiro</h3>
    <input type="text" id="name" placeholder="Seu nome" style="width:100%;padding:8px;margin-bottom:10px;">
    <input type="email" id="email" placeholder="Seu e-mail" style="width:100%;padding:8px;margin-bottom:15px;">
    <button class="next-btn" onclick="startQuiz()">Come√ßar</button>
  </div>

  <div id="quiz" class="hidden">
    <div class="counter" id="counter"></div>
    <div class="question-box" id="question"></div>
    <div id="options"></div>
    <button class="next-btn" onclick="nextQuestion()">Pr√≥ximo</button>
  </div>

  <div id="result" class="hidden"></div>
</div>

<script>
const questions = [
  {q:"Voc√™ costuma anotar tudo o que entra e sai de dinheiro da empresa?", o:["N√£o anoto nada","Anoto √†s vezes","Sim, fa√ßo esse controle com frequ√™ncia"]},
  {q:"Voc√™ costuma olhar com anteced√™ncia se ter√° dinheiro suficiente para pagar as contas do m√™s?", o:["N√£o vejo com anteced√™ncia","Olho de vez em quando","Sim, sempre vejo isso antes"]},
  {q:"Voc√™ sabe quanto tem em conta hoje e quanto vai precisar pagar nos pr√≥ximos dias?", o:["N√£o sei ao certo","Tenho uma ideia","Sim, sei com clareza"]},
  {q:"J√° passou por aperto no caixa por falta de organiza√ß√£o ou surpresa nas contas?", o:["Sim, com frequ√™ncia","√Äs vezes","Raramente ou nunca"]},
  {q:"Voc√™ usa planilha, caderno ou sistema para acompanhar o dinheiro da empresa?", o:["N√£o uso nada","Uso alguma coisa, mas √© desorganizado","Sim, tenho um controle claro e regular"]},
  {q:"Voc√™ tem controle das contas que precisa pagar? (com datas e valores)", o:["N√£o controlo","Tenho uma no√ß√£o","Sim, tenho tudo anotado e organizado"]},
  {q:"Voc√™ sabe quanto tem para receber de clientes ou conv√™nios?", o:["N√£o sei","Tenho uma ideia geral","Sim, sei os valores e prazos certinhos"]},
  {q:"O faturamento (emiss√£o de nota ou cobran√ßa) √© feito de forma organizada e no prazo certo?", o:["N√£o √© bem organizado","Fa√ßo, mas com atrasos √†s vezes","Sim, fa√ßo certinho e no prazo"]},
  {q:"Existe alguma rotina de cobran√ßa quando o cliente atrasa o pagamento?", o:["N√£o tenho nenhuma rotina","Fa√ßo quando lembro","Sim, tenho um processo de cobran√ßa"]},
  {q:"Voc√™ sabe quanto est√° em aberto para receber este m√™s e no pr√≥ximo?", o:["N√£o sei","Tenho uma ideia","Sim, sei com precis√£o"]},
  {q:"Voc√™ fecha o m√™s da empresa olhando quanto entrou, quanto saiu e quanto sobrou?", o:["Nunca fiz isso","J√° fiz, mas n√£o tenho uma rotina","Sim, fa√ßo isso todo m√™s"]},
  {q:"Voc√™ costuma ver relat√≥rios simples com os n√∫meros da empresa (receita, despesa, lucro)?", o:["N√£o vejo","Vejo de vez em quando","Sim, acompanho com frequ√™ncia"]},
  {q:"Voc√™ para para analisar os n√∫meros da empresa com s√≥cios, equipe ou sozinho?", o:["N√£o fa√ßo isso","Fa√ßo √†s vezes","Sim, fa√ßo isso com frequ√™ncia"]},
  {q:"Voc√™ se sente seguro para tomar decis√µes financeiras com base nos dados da empresa?", o:["N√£o me sinto seguro","√Äs vezes sim, √†s vezes n√£o","Sim, consigo decidir com confian√ßa"]},
  {q:"Os dados da empresa (valores, prazos, contas) est√£o organizados em um lugar f√°cil de acessar?", o:["N√£o est√£o organizados","Est√£o espalhados ou em pap√©is","Sim, est√£o centralizados e atualizados"]}
];

let currentQuestion = 0;
let answers = [];
let selectedValue = null;

function startQuiz(){
  const name = document.getElementById("name").value.trim();
  const email = document.getElementById("email").value.trim();
  if(!name || !email){
    alert("Por favor, preencha seu nome e e-mail.");
    return;
  }
  document.getElementById("user-info").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  loadQuestion();
}

function loadQuestion(){
  const q = questions[currentQuestion];
  document.getElementById("question").innerText = q.q;
  document.getElementById("counter").innerText = `Pergunta ${currentQuestion+1} de ${questions.length}`;
  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML = "";
  q.o.forEach((opt, index) => {
    const btn = document.createElement("button");
    btn.classList.add("option");
    btn.textContent = opt;
    btn.onclick = () => selectOption(btn, index);
    optionsDiv.appendChild(btn);
  });
}

function selectOption(button, value){
  document.querySelectorAll(".option").forEach(btn => btn.classList.remove("selected"));
  button.classList.add("selected");
  selectedValue = value;
}

function nextQuestion(){
  if(selectedValue === null){
    alert("Selecione uma op√ß√£o antes de continuar!");
    return;
  }
  answers.push(selectedValue);
  selectedValue = null;

  if(currentQuestion < questions.length - 1){
    currentQuestion++;
    loadQuestion();
  } else {
    finishQuiz();
  }
}

function finishQuiz() {
  document.getElementById("quiz").classList.add("hidden");
  document.getElementById("result").classList.remove("hidden");

  const total = answers.reduce((a,b) => a+b, 0);
  const score = total / 3; // transforma para 0 a 10
  let message = "";

  if (score < 4) {
    message = `Est√° dif√≠cil enxergar os n√∫meros e tomar decis√µes.<br><br>Comece organizando o b√°sico: entradas, sa√≠das e contas.`;
  } else if (score < 7) {
    message = `Voc√™ tem alguma organiza√ß√£o, mas pode melhorar muito.<br><br>Vale a pena criar uma rotina de controle e an√°lise simples.`;
  } else if (score < 9) {
    message = `Sua gest√£o j√° tem boa estrutura.<br><br>√â hora de ganhar efici√™ncia e pensar mais no futuro.`;
  } else {
    message = `Parab√©ns! Sua empresa tem uma base forte.<br><br>Continue firme, e use os dados para crescer com seguran√ßa.`;
  }

  document.getElementById("result").innerHTML = `
    <h2>Sua pontua√ß√£o: ${score.toFixed(1)}</h2>
    <p>${message}</p>
    <div style="margin-top:30px; font-size:14px; color:#102d4c;">
      <p><strong>Entre no site e veja como podemos ajudar sua empresa a crescer!</strong></p>
      <a href="https://azevedocontabilidade.com" target="_blank"
         class="visit-btn"
         style="display:inline-block; background-color:#ffb400; color:white; text-decoration:none;
                font-weight:bold; border-radius:10px; padding:12px 25px; margin-top:10px;
                transition:0.3s;">
         Visite nosso site
      </a>
    </div>
  `;

  const templateParams = {
    user_name: document.getElementById("name").value,
    user_email: document.getElementById("email").value,
    score: score.toFixed(1),
    message: message.replace(/<br>/g, "\n")
  };

  console.log("Par√¢metros para e-mail:", templateParams);

  <script>
  // üîπ Substitua pelo seu link gerado no Google Apps Script
  const scriptURL = "https://script.google.com/macros/s/AKfycbyYLJKnVVk4JPame1BRyyv--AUJ_6VXDiXkbU2Ygjl22RFUtXmtqbmEYqZ6Ur7uy_Bd/exec";

  // Captura o evento de envio do formul√°rio
  document.getElementById("formulario").addEventListener("submit", e => {
    e.preventDefault();

    // Pega os valores dos campos
    const data = {
      nome: document.getElementById("nome").value,
      email: document.getElementById("email").value,
      pontuacao: document.getElementById("pontuacao").value
    };

    // Envia os dados pra planilha via POST
    fetch(scriptURL, {
      method: 'POST',
      body: JSON.stringify(data),
    })
    .then(response => {
      alert("‚úÖ Resposta enviada com sucesso!");
      e.target.reset();
    })
    .catch(error => {
      alert("‚ùå Erro ao enviar a resposta!");
      console.error(error);
    });
  });
</script>

}
</script>
</body>
</html>

